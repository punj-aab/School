@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutBlueMoon.cshtml";
}


<div class="sub-nav">
    <ul>
        <li>
            <a class="tokens" id="lnkCreateNewToken" href="javascript:;" action="CreateToken">Create Token
            </a>
        </li>
    </ul>
    <div class="btn-group pull-right">
        <button class="btn btn-primary">
            Main Menu
           
        </button>
        <button data-toggle="dropdown" class="btn btn-primary dropdown-toggle">
            <span class="caret"></span>
        </button>
    </div>
</div>
<div class="dashboard-wrapper">
    <div class="left-sidebar" id="divOuter">
        @{Html.RenderAction("CreateToken");}
    </div>
    <div class="right-sidebar">
        @Html.Partial("_RightMenuPartial")
    </div>
</div>

@section Scripts
{

    <script type="text/javascript">

        $(document).ready(function () {

            jQuery.validator.setDefaults({
                debug: true,
                success: "valid"
            });

            $("#btnCreateToken").click(function (e) {

                var form = $("#myform");
                form.validate();
                if (!form.valid()) {
                    e.preventDefault();
                    return;
                }
                var $this = $(this);
                var objCandidate = $('#myform').serializeObject();

                $.ajax({
                    url: '/Token/Create',
                    cache: false,
                    type: 'POST',
                    contentType: 'application/json;',
                    data: JSON.stringify(objCandidate),
                    success: function (response) {
                        //console.log(response);
                        $('#divOuter').html(response);
                    },
                    error: function () { }
                });
            });

            $('#lnkCreateNewToken, #tabToken').addClass('selected');

            $('.tokens').click(function () {
                var action = $(this).attr("action");
                $.ajax({
                    type: 'POST',
                    url: '/Token/' + action,
                    success: function (response) {

                        $('#divOuter').html(response);
                    },
                    error: function () { alert("error"); }
                });
            });
        });

        $.fn.serializeObject = function () {
            var o = {};
            var a = this.serializeArray();
            $.each(a, function () {
                if (o[this.name] !== undefined) {
                    if (!o[this.name].push) {
                        o[this.name] = [o[this.name]];
                    }
                    o[this.name] = this.value || '';
                } else {
                    o[this.name] = this.value || '';
                }
            });
            return o;
        };

    </script>
}
@HelperAssets.LoadAjaxData("/Token/");
 @HelperAssets.SaveAndLoadData("/Token/", "");
